{% schema %}
{
  "name": "Media with Text Section",
  "settings": [
    {
      "type": "header",
      "content": "Section Settings"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background Color",
      "default": "#fff9f3"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text Color",
      "default": "#1a1a1a"
    }
  ],
  "blocks": [
    {
      "type": "media_text_block",
      "name": "Media with Text Block",
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "Secure technology suitable for most skin and hair types"
        },
        {
          "type": "textarea",
          "id": "description",
          "label": "Description",
          "default": "Our technology adapts to your skin type for optimal results safely. Thanks to PrecisionPulseâ„¢ IPL technology, which flashes at 10 ms, up to 4 times longer than competing IPL, the light is primarily absorbed by the melanin in your hair and not by that in your skin."
        },
        {
          "type": "select",
          "id": "media_type",
          "label": "Media Type",
          "options": [
            { "value": "image", "label": "Image" },
            { "value": "video", "label": "Video" }
          ],
          "default": "image"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image",
          "info": "Upload an image if media type is set to 'Image'"
        },
        {
          "type": "url",
          "id": "video_url",
          "label": "Video URL",
          "info": "Enter a direct video URL (e.g., .mp4 hosted on your store) if media type is set to 'Video'"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Media with Text Section",
      "category": "Custom"
    }
  ]
}
{% endschema %}

<div class="media-text-section section section-blends section-full">
  <div class="bg-custom py-8" style="--background: {{ section.settings.background_color | split: '#' | last | replace: ' ', '' }}; --text-color: {{ section.settings.text_color | split: '#' | last | replace: ' ', '' }};">
    <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">
      {% for block in section.blocks %}
        <div class="media-with-text flex flex-col items-center gap-6 {% if forloop.last == false %}mb-6{% endif %}" {{ block.shopify_attributes }}>
          <div class="media-with-text__media rounded w-full md:w-1/2" reveal-on-scroll="true" style="opacity: 1;">
            {% if block.settings.media_type == "image" and block.settings.image %}
              <img src="{{ block.settings.image | img_url: '600x' }}" alt="" loading="lazy" sizes="(max-width: 999px) 100vw, min(650px, 50vw)" style="width: 100%; height: auto; transform: scale(1);">
            {% elsif block.settings.media_type == "video" and block.settings.video_url %}
              <video src="{{ block.settings.video_url }}" autoplay loop muted style="width: 100%; height: auto; min-height: 300px;" playsinline>
                Your browser does not support the video tag.
              </video>
            {% else %}
              <div class="w-full h-64 bg-gray-200 rounded"></div>
            {% endif %}
          </div>
          <div class="media-with-text__content rounded w-full md:w-1/2 bg-custom text-custom p-4" style="--background: {{ section.settings.background_color | split: '#' | last | replace: ' ', '' }}; --text-color: {{ section.settings.text_color | split: '#' | last | replace: ' ', '' }};">
            <div class="prose break-all text-center md:text-left" reveal-on-scroll="true" style="opacity: 1;">
              <p class="text-xl md:text-2xl font-bold">{{ block.settings.title }}</p>
              <p class="text-base mt-2">{{ block.settings.description }}</p>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const mediaTextItems = document.querySelectorAll('.media-text-section .media-with-text');
    mediaTextItems.forEach((item, index) => {
      if (index % 2 === 0) {
        // Even index (0, 2, 4, ...): media on the right
        item.classList.add('md:flex-row-reverse');
      } else {
        // Odd index (1, 3, 5, ...): media on the left
        item.classList.add('md:flex-row');
      }
    });
  });
</script>

<style>
  .media-text-section {
    padding: 20px 10px;
  }

  .bg-custom {
    background-color: rgb(var(--background, 255 249 243));
    color: rgb(var(--text-color, 26 26 26));
  }

  .text-custom {
    color: rgb(var(--text-color, 26 26 26));
  }

  .py-8 {
    padding-top: 2rem;
    padding-bottom: 2rem;
  }

  .max-w-5xl {
    max-width: 64rem;
  }

  .mx-auto {
    margin-left: auto;
    margin-right: auto;
  }

  .px-4 {
    padding-left: 1rem;
    padding-right: 1rem;
  }

  .sm:px-6 {
    padding-left: 1.5rem;
    padding-right: 1.5rem;
  }

  .lg:px-8 {
    padding-left: 2rem;
    padding-right: 2rem;
  }

  .flex {
    display: flex;
  }

  .flex-col {
    flex-direction: column;
  }

  .md:flex-row {
    flex-direction: row;
  }

  .md:flex-row-reverse {
    flex-direction: row-reverse;
  }

  .items-center {
    align-items: center;
  }

  .gap-6 {
    gap: 1.5rem;
  }

  .mb-6 {
    margin-bottom: 1.5rem;
  }

  .media-with-text__media {
    width: 100%;
  }

  .media-with-text__content {
    width: 100%;
  }

  .rounded {
    border-radius: 0.5rem;
  }

  .p-4 {
    padding: 1rem;
  }

  .text-xl {
    font-size: 1.25rem;
    line-height: 1.75rem;
  }

  .md:text-2xl {
    font-size: 1.5rem;
    line-height: 2rem;
  }

  .font-bold {
    font-weight: 700;
  }

  .text-base {
    font-size: 1rem;
    line-height: 1.5rem;
  }

  .mt-2 {
    margin-top: 0.5rem;
  }

  .prose p {
    margin: 0;
  }

  /* Responsive Adjustments */
  @media (max-width: 768px) {
    .text-xl {
      font-size: 1.125rem;
    }

    .md:text-2xl {
      font-size: 1.25rem;
    }

    .text-base {
      font-size: 0.875rem;
    }

    .p-4 {
      padding: 0.75rem;
    }

    .gap-6 {
      gap: 1rem;
    }
  }
</style>
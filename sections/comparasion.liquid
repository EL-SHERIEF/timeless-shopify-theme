{% schema %}
{
  "name": "Comparison Table",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme"
    },
    {
      "type": "richtext",
      "id": "content",
      "label": "Content",
      "default": "<h2>Why Choose Us?</h2>"
    },
    {
      "type": "richtext",
      "id": "subcontent",
      "label": "Subcontent",
      "default": "<p>Compare our features against the competition.</p>"
    }
  ],
  "blocks": [
    {
      "type": "feature",
      "name": "Feature",
      "settings": [
        { "type": "text", "id": "name", "label": "Feature Name" },
        { "type": "checkbox", "id": "ours", "label": "We have this feature" },
        { "type": "checkbox", "id": "competitor_1", "label": "Competitor 1 has this feature" },
        { "type": "checkbox", "id": "competitor_2", "label": "Competitor 2 has this feature" },
        { "type": "checkbox", "id": "competitor_3", "label": "Competitor 3 has this feature" },
        { "type": "richtext", "id": "reason_ours", "label": "Reason (Ours)", "default": "<p>Why we have this feature.</p>" },
        { "type": "richtext", "id": "reason_competitor_1", "label": "Reason (Competitor 1)", "default": "<p>Competitor 1's reason.</p>" },
        { "type": "richtext", "id": "reason_competitor_2", "label": "Reason (Competitor 2)", "default": "<p>Competitor 2's reason.</p>" },
        { "type": "richtext", "id": "reason_competitor_3", "label": "Reason (Competitor 3)", "default": "<p>Competitor 3's reason.</p>" }
      ]
    }
  ]
}
{% endschema %}

<section class="py-24 bg-gray-100">
  <div class="container mx-auto px-6">
    <div class="text-center mb-10">
      <h2 class="text-3xl font-bold text-gray-900">{{ section.settings.content }}</h2>
      <p class="mt-4 text-gray-700">{{ section.settings.subcontent }}</p>
    </div>
    
    <div class="w-full">
      <div class="flex border-b">
        {% assign tabs = "ours,competitor_1,competitor_2,competitor_3" | split: "," %}
        {% for tab in tabs %}
        <button class="tab-button py-3 px-4 text-gray-800 bg-black/[.05] focus:border-gray-800 mx-2 rounded-xl" onclick="openTab(event, 'tab-{{ tab }}')">{{ tab | replace: "_", " " | capitalize }}</button>
        {% endfor %}
      </div>
      
      {% for tab in tabs %}
      <div id="tab-{{ tab }}" class="tab-content p-4 hidden">
        <table class="w-full bg-white shadow-md rounded-lg overflow-hidden">
          <thead class="bg-gray-800 text-white">
            <tr>
              <th class="py-4 px-6 text-left">Feature</th>
              <th class="py-4 px-2 text-center">Available</th>
              <th class="py-4 px-6 text-left">Reason</th>
            </tr>
          </thead>
          <tbody>
            {% for block in section.blocks %}
            {% assign reason_key = "reason_" | append: tab %}
            <tr class="border-b">
              <td class="py-4 px-6 font-semibold">{{ block.settings.name }}</td>
              <td class="py-4 px-2 text-center">{% if block.settings[tab] %}<span class="text-green-500 text-2xl">✔</span>{% else %}<span class="text-red-500 text-2xl">✖</span>{% endif %}</td>
              <td class="py-4 px-6 text-gray-600">{{ block.settings[reason_key] }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% endfor %}
    </div>
  </div>
</section>

<script>
  function openTab(event, tabId) {
    document.querySelectorAll('.tab-content').forEach(tab => tab.classList.add('hidden'));
    document.getElementById(tabId).classList.remove('hidden');
    document.querySelectorAll('.tab-button').forEach(button => button.classList.remove('border-gray-800'));
    event.currentTarget.classList.add('border-gray-800');
  }
</script>

<style>
  .hidden { display: none; }
</style>

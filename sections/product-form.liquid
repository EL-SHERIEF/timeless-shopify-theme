{%- liquid
  if product.has_only_default_variant
    assign p = product
  else
    assign p = product.selected_or_first_available_variant
  endif
-%}

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css">

<div class="section-product-form grid sm:grid-cols-2 items-start gap-8 md:gap-12 px-6 sm:px-12 lg:px-20 xl:px-32 2xl:px-48">
  <div class="relative">
    {% render 'product-image-carousel' %}
  </div>

  <div class="grid gap-6">
    {% form 'product', product, class: 'grid gap-4' %}
      {% for block in section.blocks %}
        {%- case block.type -%}
          {%- when '@app' -%}
            {% render block %}

          {%- when 'buy-button' -%}
            <div class="flex flex-col sm:flex-row gap-4">
              <button
                class="w-full sm:w-auto px-6 py-3 text-lg font-semibold text-white bg-black rounded-lg hover:bg-gray-900 transition disabled:opacity-50"
                type="submit"
                {% unless product.available or product.selected_or_first_available_variant.available %}disabled{% endunless %}
              >
                {{ block.settings.text | default: 'Add to cart' | escape }}
              </button>

              {%- if block.settings.show_payment_buttons -%}
                {{ form | payment_button }}
              {%- endif -%}
            </div>

          {%- when 'description' -%}
            <div class="text-gray-600 leading-relaxed text-lg">
              {{ product.description | replace: '<meta charset="utf-8">', '' }}
            </div>

          {%- when 'divider' -%}
            <div class="border-t border-gray-200 my-6"></div>

          {%- when 'inventory' -%}
            <p class="text-sm text-gray-500">
              {% render 'inventory', text: block.settings.text %}
            </p>

          {%- when 'price' -%}
            <div class="text-2xl font-semibold text-gray-900">
              {%- render 'price', show_taxes_included: true -%}
            </div>

          {%- when 'quantity-selector' -%}
            <label class="flex flex-col gap-2">
              <span class="text-xs text-gray-500 uppercase">Quantity</span>
              {% render 'quantity-selector' %}
            </label>

          {%- when 'sku' -%}
            {%- assign sku = product.selected_or_first_available_variant.sku -%}
            <p class="text-xs text-gray-400" {% if sku == blank %}hidden{% endif %}>
              SKU: <code class="font-mono text-gray-600">{{ sku }}</code>
            </p>

          {%- when 'title' -%}
            <h1 class="text-3xl font-bold tracking-tight text-gray-900">{{ product.title }}</h1>

          {%- when 'variant-selector' -%}
            <div class="mt-4">{% render 'variant-selector' %}</div>

          {%- when 'vendor' -%}
            <p class="text-xs uppercase tracking-wide text-gray-500">{{ product.vendor }}</p>

        {%- endcase -%}
      {% endfor %}
    {% endform %}

    {%- if section.settings.show_pickup_availability -%}
      {% render 'pickup-availability' %}
    {%- endif -%}
  </div>
</div>

<style type="text/tailwindcss">
  .section-product-form {
    @apply max-w-7xl mx-auto;
  }
  .product-thumbs .swiper-slide {
    @apply relative transition-transform scale-90;
  }
  .product-thumbs .swiper-slide-thumb-active {
    @apply scale-100;
  }
</style>

{% render 'product-form-js' %}
{% render 'product-schema' %}

{% schema %}
{
  "name": "Product form",
  "tag": "article",
  "class": "section-product-form",
  "limit": 1,
  "settings": [
    {
      "type": "checkbox",
      "id": "show_pickup_availability",
      "label": "Show pickup availability",
      "default": false
    }
  ],
  "blocks": [
    {
      "type": "buy-button",
      "name": "Buy Button",
      "settings": [
        {
          "type": "text",
          "id": "text",
          "label": "Button Text",
          "default": "Add to cart"
        },
        {
          "type": "checkbox",
          "id": "show_payment_buttons",
          "label": "Show Shopify payment buttons",
          "default": false
        }
      ]
    },
    {
      "type": "description",
      "name": "Description",
      "limit": 1
    },
    {
      "type": "price",
      "name": "Price",
      "limit": 1
    },
    {
      "type": "quantity-selector",
      "name": "Quantity Selector",
      "limit": 1
    },
    {
      "type": "sku",
      "name": "SKU",
      "limit": 1
    },
    {
      "type": "title",
      "name": "Title",
      "limit": 1
    },
    {
      "type": "variant-selector",
      "name": "Variant Selector",
      "limit": 1
    },
    {
      "type": "vendor",
      "name": "Vendor",
      "limit": 1
    }
  ]
}
{% endschema %}

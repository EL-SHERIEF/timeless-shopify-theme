<!-- wa-btn.liquid -->
<div class="fixed right-2 sm:right-4 bottom-4 flex items-center z-10" id="wa-btn-wrapper">
  <!-- WhatsApp Icon -->
  <div 
    class="rounded-full p-4 text-black flex items-center justify-center" 
    style="background-color: {{ section.settings.icon_bg_color }}"
    onmouseover="showInput()" 
    onmouseout="hideInput()"
  >
    <img src="{{ section.settings.whatsapp_icon }}" alt="WhatsApp Icon" class="w-8 h-8">
  </div>

  <!-- Message Input and Send Button -->
  <div 
    id="wa-input-wrapper"
    class="hidden flex items-center gap-3 transition-opacity duration-150 ps-4"
  >
    <textarea 
      id="wa-message-input"
      class="bg-gray-800 text-white placeholder-gray-400 p-[10px] overflow-hidden resize-none max-h-[45px] rounded-xl outline-none ring-8 ring-gray-700 w-64"
      placeholder="{{ section.settings.placeholder_text }}"
    ></textarea>

    <a 
      id="wa-send-btn"
      class="rounded-2xl p-[17px] flex items-center justify-center"
      href="#"
      style="background-color: {{ section.settings.send_btn_bg_color }}; color: {{ section.settings.send_btn_icon_color }};"
    >
      <img src="{{ section.settings.send_icon }}" alt="Send Icon" class="w-7 h-7">
    </a>
  </div>
</div>

<!-- Dynamic Behavior -->
<script>
  function showInput() {
    document.getElementById("wa-input-wrapper").classList.remove("hidden");
  }

  function hideInput() {
    const input = document.getElementById("wa-message-input").value;
    if (!input) {
      document.getElementById("wa-input-wrapper").classList.add("hidden");
    }
  }

  document.getElementById("wa-message-input").addEventListener("input", function() {
    const phoneNumber = "{{ section.settings.phone_number }}";
    const message = encodeURIComponent(this.value);
    const waLink = `https://wa.me/${phoneNumber}?text=${message}`;
    document.getElementById("wa-send-btn").setAttribute("href", waLink);
  });
</script>

<!-- Schema Definition -->
{% schema %}
{
  "name": "WhatsApp Button",
  "settings": [
    {
      "type": "text",
      "id": "phone_number",
      "label": "WhatsApp Phone Number",
      "default": "1234567890"
    },
    {
      "type": "text",
      "id": "placeholder_text",
      "label": "Placeholder Text",
      "default": "Type a message"
    },
    {
      "type": "color",
      "id": "icon_bg_color",
      "label": "Icon Background Color",
      "default": "#00FF1E"
    },
    {
      "type": "image_picker",
      "id": "whatsapp_icon",
      "label": "WhatsApp Icon"
    },
    {
      "type": "image_picker",
      "id": "send_icon",
      "label": "Send Icon"
    },
    {
      "type": "color",
      "id": "send_btn_bg_color",
      "label": "Send Button Background Color",
      "default": "#202C33"
    },
    {
      "type": "color",
      "id": "send_btn_icon_color",
      "label": "Send Button Icon Color",
      "default": "#FFFFFF"
    }
  ]
}
{% endschema %}

{%- liquid
  if section.settings.filters_position == 'left'
    assign sidebar_enabled = true
  else
    assign sidebar_enabled = false
  endif
-%}

<header class="rte">
  <h1>{{ collection.title }}</h1>
  {{ collection.description }}
</header>

<div class="flex flex-col {% if sidebar_enabled %}md:flex-row{% endif %} gap-8">
  {%- if section.settings.filters_enabled -%}
    <aside class="
      pt-2 <sm:full-width
      {% if sidebar_enabled %}w-full basis-[300px] p-4 self-start md:sticky-below-header [--offset:.5rem]
      {% else %}p-6 <md:px-4
      {% endif %}
    ">
      <h2 class="technical text-sm -mt-4 {% if sidebar_enabled %}mb-3{% else %}mb-2{% endif %}">Filters</h2>
      {% render 'filters', results: collection, stacked: sidebar_enabled %}
    </aside>
  {%- endif -%}

  {% paginate collection.products by section.settings.page_size %}
    {% render 'product-grid'
      products: collection.products
      size: section.settings.grid_item_size
    %}

    {%- if paginate.pages > 1 -%}
      <nav class="pagination">{{ paginate | default_pagination }}</nav>
    {%- endif -%}
  {% endpaginate %}
</div>

<style>
  #shopify-section-{{ section.id }} aside {
    --canvas: {{ section.settings.filters_color_scheme.settings.canvas }};
    --ink: {{ section.settings.filters_color_scheme.settings.ink }};
    background-color: var(--canvas);
    color: var(--ink);
  }
</style>

{% schema %}
{
  "name": "Collection",
  "tag": "section",
  "class": "section grid gap-12",
  "settings": [
    {
      "type": "range",
      "id": "grid_item_size",
      "label": "Grid item size",
      "unit": "px",
      "min": 100,
      "max": 350,
      "step": 10,
      "default": 180
    },
    {
      "type": "number",
      "id": "page_size",
      "label": "Products per page",
      "default": 12
    },
    {
      "type": "header",
      "content": "Filters"
    },
    {
      "type": "checkbox",
      "id": "filters_enabled",
      "label": "Enable filters",
      "default": true
    },
    {
      "type": "select",
      "id": "filters_position",
      "label": "Position",
      "options": [
        {
          "value": "top",
          "label": "top"
        },
        {
          "value": "left",
          "label": "left"
        }
      ],
      "default": "left"
    },
    {
      "type": "color_scheme",
      "id": "filters_color_scheme",
      "label": "Color scheme"
    }
  ]
}
{% endschema %}
